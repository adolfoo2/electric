<!DOCTYPE html>
<html lang="en">
<head>
	
	<!--
		Basic
	-->
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
	<title>Electric - LatAm</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
	<meta name="description" content="vCard & Resume Template" />
	<meta name="keywords" content="vcard, resposnive, resume, personal, card, cv, cards, portfolio" />
	<meta name="author" content="beshleyua" />
	
	<!--
		Load Fonts
	-->
	<link href="https://fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond:300,300i,400,400i,500,500i,600,600i,700,700i&amp;subset=cyrillic" rel="stylesheet">
	
	<!--
		Load CSS
	-->
	<link rel="stylesheet" href="css/basic.css" />
	<link rel="stylesheet" href="css/layout.css" />
	<link rel="stylesheet" href="css/blogs.css" />
	<link rel="stylesheet" href="css/line-awesome.css" />
	<link rel="stylesheet" href="css/magnific-popup.css" />
	<link rel="stylesheet" href="css/animate.css" />
	<link rel="stylesheet" href="css/simplebar.css" />
	<link rel="newest stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

	<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
	
	<!-- theme colors -->
	<link rel="stylesheet" href="css/theme-colors/green.css" />
	<!--<link rel="stylesheet" href="css/theme-colors/blue.css" />-->
	<!--<link rel="stylesheet" href="css/theme-colors/red.css" />-->
	<!--<link rel="stylesheet" href="css/theme-colors/orange.css" />-->
	<!--<link rel="stylesheet" href="css/theme-colors/pink.css" />-->
	<!--<link rel="stylesheet" href="css/theme-colors/purple.css" />-->
	
	<!--[if lt IE 9]>
	<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<!--
		Favicons
	-->
	<link rel="shortcut icon" href="images/favicons/favicon.ico">
	<script>

		$(document).ready(function() {
			$(".js-otro-tokenizer").select2({
			tags: true,
			tokenSeparators: [',', ' '],
			maximumSelectionLength: 15,
			placeholder: 'Indique hasta 15 estudios.'
		});
	});
	</script>
</head>

<body>

	<div class="page">

		<!--
			Preloader
		-->
		<div class="preloader">
			<div class="centrize full-width">
				<div class="vertical-center">
					<div class="spinner">
						<div class="double-bounce1"></div>
						<div class="double-bounce2"></div>
					</div>
				</div>
			</div>
		</div>
		
		<!--
			Header
		-->
		<header class="header">

			<!-- logo -->
			<div class="logo">
				<a href="#"><span>P</span></a>
			</div>

			<!-- menu 
			<div class="top-menu">
				<ul>
					<li class="active">
						<a href="./index.html">
							<span class="icon la la-home"></span>
							<span class="link">Home</span>
						</a>
					</li>
					<li>
						<a href="./perfil.html">
							<span class="icon la la-user"></span>
							<span class="link">Perfil</span>
						</a>
					</li>
					<li>
						<a href="#resume-card">
							<span class="icon la la-gear"></span>
							<span class="link">Resume</span>
						</a>
					</li>
					<li>
						<a href="#works-card">
							<span class="icon la la-eye"></span>
							<span class="link">Portfolio</span>
						</a>
					</li>
					<li>
						<a href="#blog-card">
							<span class="icon la la-newspaper-o"></span>
							<span class="link">Blog</span>
						</a>
					</li>
					<li>
						<a href="#contacts-card">
							<span class="icon la la-envelope"></span>
							<span class="link">Contacts</span>
						</a>
					</li>
				</ul>
			</div>-->

			<!-- Started socials -->
			<div class="social">
				<a target="_blank" href="https://facebook.com/"><span class="icon la la-facebook"></span></a>
			</div>

			<!-- Mobile Menu -->
			<span class="menu-btn">
				<span class="m-line"></span>
			</span>

		</header>

		<!--
			Container
		-->
		


			<!--
				Card - Started
			-->
			<div class="card-inner card-started active" id="home-card">

				<div class="row card-container">

					<!--
						Card Wrap
					-->
					<div class="card-wrap col col-m-12 col-t-12 col-d-12 col-d-lg-12" data-simplebar>
						
						<!-- About Image 
						<div class="card-image col col-m-12 col-t-12 col-d-4 col-d-lg-6" style="background-image: url(images/profile.jpg);"></div>
						-->
						<!--
							Inner Top
						-->
						
						<div class="content inner-top">
							<div class="row">
								
								<div class="col col-m-12 col-t-12 col-d-12 col-d-lg-12">
									<div class="title-bg">  </div>
									<div class="text">
										<p>
											<strong>Crear una cuenta</strong>
											
											<div class="row">
												<div class="col col-m-12 col-t-12 col-d-12 col-d-lg-6">
				
													<!-- form -->

													
													<div class="contact_form card-box">
														<form class="pt-3">


															<div class="col-m-12 col-t-12 col-d-12 col-d-lg-6">
																<div class="col m6 offset-m3 center-align">
																	<div class="white-text">Comienza con tu cuenta gratuita </p></div>
																		<a class="oauth-container btn darken-4 white black-text" onClick="google()" style="text-transform:none">
																			
																				<img width="20px" style="margin-top:0px; margin-right:10px" alt="Google sign-in" 
																					src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/53/Google_%22G%22_Logo.svg/512px-Google_%22G%22_Logo.svg.png" />
																			
																			Continuar con Google
																		</a>
																		<br>
																	</div>
																<!--<div class="col col-m-12 col-t-6 col-d-6 col-d-lg-6">
																	<div class="group-val">
																		<input type="text" name="name" placeholder="Full Name" />
																	</div>
																</div>-->
																<br><br>
																	

																<div class="input-group col">
																	<span class="white-text center-align">O</span><br>
																</div>

																<div class="input-group mb-3 form-group">
																	<div class="input-group-prepend">
																		
																		<label class="input-group-text" for="inputGroupSelect01">Tipo de usuario</label>
																	</div>
																	<select class="custom-select" id="tipo_usuario" onchange="tipoChange()">
																		<option selected>Selecciona un tipo</option>
																		<option value="estudiante">Estudiante</option>
																		<option value="profesional">Profesional</option>
																		<option value="prestador">Prestador de servicios</option>
																		<option value="empresa">Empresa</option>
																	</select>
																</div>

																
															</div>

															
															<div class="col-m-12 col-t-12 col-d-12 col-d-lg-8 align-left " style="color:blanchedalmond" id=radio >
																<div class="custom-control custom-radio" onchange="areaOff()">
																	<input type="radio" id="areaRadio1" name="customRadio" class="custom-control-input"  value="electricidad">
																	<label  style='font-size: 16px;' class="custom-control-label " for="areaRadio1">Electricidad</label>
																</div>
																<div class="custom-control custom-radio" onchange="areaOff()">
																	<input type="radio" id="areaRadio2" name="customRadio" class="custom-control-input" value="electronica">
																	<label  style='font-size: 16px;' class="custom-control-label" for="areaRadio2">Electrónica</label>
																</div>
																<div class="custom-control custom-radio" onchange="areaOff()">
																	<input type="radio" id="areaRadio3" name="customRadio" class="custom-control-input" value="telecomunicaciones">
																	<label  style='font-size: 16px;' class="custom-control-label" for="areaRadio3">Telecomunicaciones</label>
																</div>
																<div class="custom-control custom-radio" onchange="areaOff()">
																	<input type="radio" id="areaRadio4" name="customRadio" class="custom-control-input" value="automatizacion">
																	<label  style='font-size: 16px;' class="custom-control-label" for="areaRadio4">Automatización</label>
																</div>
																<div class="custom-control custom-radio" onchange="areaOn()">
																	<input type="radio" id="areaRadio5" name="customRadio" class="custom-control-input" value="otros">
																	<label style='font-size: 16px;' class="custom-control-label" for="areaRadio5">Otros</label>
																	
																</div>
															</div>
															<div style="display:none" id="otro" class='col-md-6 mb-6 align-left' style="color:black" >
																<select style ="width: 250px;"  class="js-otro-tokenizer form-control" multiple="multiple" id='otros'>
																	<option value="seguridad">Seguridad</option>
																	<option value="mecanica">Mecánica</option>
																	<option value="derecho">Derecho</option>
																	<option value="prevencion">Prevención</option>
																  </select>
															</div>
															<br>
															<div class="col-md-6 mb-6 align-left" style="color:blanchedalmond">
																<div class="group-val" id="datos">
																
																</div>
															</div>
															
															<div class="mt-3">
																<button class="btn btn-block btn-primary btn-lg font-weight-medium auth-form-btn" type="button" onClick="iniciar(this.form)">Continuar<span class="icon"><i class="la la-arrow-right"></i></span></button>
															  </div>
														</form>
														<div class="alert-success">
															<p> </p>
														</div>
													</div>
				
												</div>
											</div>
										
									</div>

									<div class="circle-bts">
										<!--<a href="#"><span></span></a>-->
										
									</div>
								</div>
							</div>
						</div>

					</div>
					
				</div>
			</div>
		
			</div>
			
			<script>
				function tipoChange() {
				  	var tipo = document.getElementById("tipo_usuario").value;
					var nombre =     "<div class='mb-6' >"+
						"<label style='font-size: 16px;' for='name'>Nombre</label>"+
						"<input type='text' class='form-control' id='name' placeholder='Nombre' required></div>";
					var apellidop =    "<div class='mb-6'>"+
						"<label style='font-size: 16px; for='apellidop'>Apellido Paterno</label>"+
						"<input type='text' class='form-control' id='apellidop' placeholder='Apellido Paterno' required></div>";
					var apellidom =   "<div class='mb-6'>"+
						"<label style='font-size: 16px; for='apellidom'>Apellido Materno</label>"+
						"<input type='text' class='form-control' id='apellidom' placeholder='Apellido Materno' required></div>";
					var telefono =   "<div class='mb-6'>"+
						"<label style='font-size: 16px; for='telefono'>Teléfono</label>"+
						"<input type='number' class='form-control' id='telefono' placeholder='5612312300' required></div>";
					var correo =     "<div class='form-group'><div class='mb-6'>"+
						"<label style='font-size: 16px; for='correo'>Correo</label>"+
						"<input type='email' class='form-control' id='correo' placeholder='micorreo@gmail.com' required></div></div>";
					var pass =     "<div class='form-group'><div class='mb-6'>"+
						"<label style='font-size: 16px; for='pass'>Contraseña</label>"+
						"<input type='password' class='form-control' id='pass' placeholder='*******' required></div></div>";
				  if(tipo!="empresa"){
				  	document.getElementById("datos").innerHTML = nombre+apellidop+apellidom+telefono+correo+pass;
				  }else{
					var nombreE =     "<div class='mb-6'>"+
						"<label style='font-size: 16px; for='name'>Nombre Empresa</label>"+
						"<input type='text' class='form-control' id='name' placeholder='Nombre' required></div>";
					var correoE =     "<div class='form-group'><div class='mb-6'>"+
						"<label style='font-size: 16px; for='correo'>Correo Empresa</label>"+
						"<input type='email' class='form-control' id='correo' placeholder='micorreo@gmail.com' required></div></div>";
					document.getElementById("datos").innerHTML = nombreE+telefono+correoE+pass; 
				  }
				}

				function areaOff() {
				  	document.getElementById('otro').style.display = "none";
				}

				function areaOn() {
					  document.getElementById('otro').style.display = "block";
					  document.getElementById('otro').style.color = "black";
					  //document.getElementById('otro').style ="width: 180px;"
				}
			</script>
			<!-- 
				Lines Grid
			-->
			<div class="lines-grid">
				<div class="row">
					<div class="col col-m-12 col-t-6 col-d-4 col-d-lg-3"></div>
					<div class="col col-m-12 col-t-6 col-d-4 col-d-lg-3">
						<div class="lines">
							<div class="line-1"></div>
							<div class="line-2" style="animation-delay: 10s;"></div>
						</div>
					</div>
					<div class="col col-m-12 col-t-6 col-d-4 col-d-lg-3">
						<div class="lines">
							<div class="line-1"></div>
						</div>
					</div>
					<div class="col col-m-0 col-t-0 col-d-0 col-d-lg-3">
						<div class="lines">
							<div class="line-1"></div>
							<div class="line-2" style="animation-delay: 0s;"></div>
						</div>
					</div>
				</div>
			</div>

		</div>
	</div>
	
	<!--
		jQuery Scripts
	-->
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery.validate.js"></script>
	<script src="js/jquery.magnific-popup.js"></script>
	<script src="js/imagesloaded.pkgd.js"></script>
	<script src="js/masonry.pkgd.js"></script>
	<script src="js/masonry-filter.js"></script>
	<script src="js/simplebar.js"></script>
	<script src="js/typed.js"></script>
	

	
	<!--
		Main Scripts
	-->
	<script src="js/scripts.js"></script>
	
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/css/materialize.min.css">
	<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/css/select2.min.css" rel="stylesheet" />
	<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-beta.1/dist/js/select2.min.js"></script>
</body>



</script> 
<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-storage.js"></script>
<script>
  // Initialize Firebase
  var config = {
	apiKey: "AIzaSyBdAIe1K0LqZ7Vwm0g1uK2G-dB_fd6ClPo",
	authDomain: "electric-latam.firebaseapp.com",
	databaseURL: "https://electric-latam.firebaseio.com",
	projectId: "electric-latam",
	storageBucket: "electric-latam.appspot.com",
  };
  
  firebase.initializeApp(config);

  // make auth and firestore references
  const auth = firebase.auth();
  const db = firebase.firestore();

var storageRef = firebase.storage().ref();

  var database = firebase.database();

</script>

<script type="text/javascript">
  	function google(){				
		var provider = new firebase.auth.GoogleAuthProvider();
		firebase.auth().signInWithPopup(provider).then(function(result) {
			// This gives you a Google Access Token. You can use it to access the Google API.
			var token = result.credential.accessToken;
			// The signed-in user info.
			var user = result.user;
			// ...
		
		}).catch(function(error) {
			// Handle Errors here.
			var errorCode = error.code;
			var errorMessage = error.message;
			// The email of the user's account used.
			var email = error.email;
			// The firebase.auth.AuthCredential type that was used.
			var credential = error.credential;
			// ...
			console.log(errorMessage);
		});
	}

	function iniciar(form){
		var tipo = form.tipo_usuario.value;
		var telefono = form.telefono.value;
		var area = form.customRadio.value;
		var email = form.correo.value;
		var nombre = form.name.value;
		var otro = document.getElementById('otro').style.display;
		if(tipo=="empresa"){

		}else{
			var apellidom = form.apellidom.value;
			var apellidop = form.apellidop.value;
		}
		//console.log(area);
		
		var password = form.pass.value;
		email = email.toLowerCase();
		email = email.trim();
		var flag = true;
		var flagOtro = false;
		var activada = false;
		if(otro =="block"){
			flagOtro = true;
			var otros = $('.js-otro-tokenizer').select2('data');
			var otrosString = "";
			for(var i = 0;i< otros.length;i++){
				otrosString = otrosString+otros[i].text;
				if((i+1)!=otros.length){
					otrosString = otrosString+",";
				}
			}

			if(otrosString ==""){
				alert("Ingrese al menos un campo en otros"); 
				flag = false;
			}else{
				area=otrosString;
			}
		}
		if(tipo !="empresa" && (telefono =="" || area =="" || email =="" || nombre =="" ||  apellidom =="" ||  apellidop =="" )){
			alert("Ingrese todos los campos"); 
			flag = false;
		}
		if(tipo =="empresa" && (telefono =="" || area =="" || email =="" || nombre =="")){
			alert("Ingrese todos los campos"); 
			flag = false;
		}
		if(flag){
			firebase.auth().createUserWithEmailAndPassword(email, password).then(function(result) {
				//guardar en BD
				var user = firebase.auth().currentUser;
				var userID = user.uid;
				if(tipo =="empresa"){
					db.collection('users').doc(userID).set({
						userID: userID,
						telefono : telefono,
						email : email,
						nombre : nombre,
						tipo : tipo,
						area:area,
						faseregistro:1,
						activada:activada,
						nivel:0
					}).then(function(docRef) {
						//pasar a segunda hoja empresa
						window.location.href = 'registro2em.html';
					})
				}else{
					db.collection('users').doc(userID).set({
						userID: userID,
						telefono : telefono,
						email : email,
						nombre : nombre,
						tipo : tipo,
						area:area,
						apellidom:apellidom,
						apellidop,apellidop,
						faseregistro:1,
						activada:activada,
						nivel:0
					}).then(function(docRef) {
						//pasar a segunda hoja
						if(tipo =="estudiante"){
							window.location.href = 'registro2e.html';
						}else{
							window.location.href = 'registro2p.html';
						}
					})
				}
    		
  			}).catch(function(error) {
			// Handle Errors here.
			var errorMessage = error.message;
			//console.log(errorMessage);
			if(errorMessage=="Password should be at least 6 characters"){
				alert("Clave demasiado débil"); 
			}
			if(errorMessage=="The email address is already in use by another account."){
				alert("El correo ta está siendo utilizado"); 
			}
			// ...
			});
		}
  
	}
	auth.onAuthStateChanged(user => {
    var user = firebase.auth().currentUser;
    if(user===null){
		//se espera que este aqui

	}else{
		var docRef = db.collection("users").doc(user.uid);
      	docRef.get().then(function(doc) {
			if(doc.data()===undefined){
				console.log("google");
				//window.location.href = 'registroG.html';
			}else{    		
				var faseregistro = doc.data().faseregistro;
				var tipo = doc.data().tipo;
				if(faseregistro==2){
						window.location.href = 'registro3.html';
				}else if(faseregistro==3){
					//ya habia temrinado el registro
					window.location.href = 'perfil.html';
				}else if(faseregistro==1){
					if(tipo=="estudiante"){
						window.location.href = 'registro2e.html';
					}else if(tipo=="empresa"){
						window.location.href = 'registro2em.html';
					}else{
						window.location.href = 'registro2p.html';
					}
				}	
			}
	  	})
	}
})
  
	  </script>
	
</html>